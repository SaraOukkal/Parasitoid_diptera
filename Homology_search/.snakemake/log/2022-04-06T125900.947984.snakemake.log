Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cluster nodes: 200
Job counts:
	count	jobs
	1	Filter_loci
	1	all
	2

[Wed Apr  6 12:59:05 2022]
rule Filter_loci:
    input: /beegfs/data/bguinet/these/NR_db, /beegfs/data/bguinet/taxadb2/taxadb.sqlite, /beegfs/data/soukkal/StageM2/Databases/Refseq_viral_db_nophages_nopolydna_IVSPER.faa
    output: /beegfs/data/soukkal/StageM2/Control_genomes/results/Viral_Homology_results/Viral_loci/Candidate_viral_loci_Nr.m8, /beegfs/data/soukkal/StageM2/Control_genomes/results/Viral_Homology_results/Viral_loci/Candidate_viral_loci_Nr_taxid.m8, /beegfs/data/soukkal/StageM2/Control_genomes/results/Viral_Homology_results/Viral_loci/Candidate_viral_loci_filtered.m8, /beegfs/data/soukkal/StageM2/Control_genomes/results/Viral_Homology_results/Viral_loci/Fasta_viral_loci_filtered.fna, /beegfs/data/soukkal/StageM2/Control_genomes/results/Viral_Homology_results/Viral_loci/Fasta_viral_loci_filtered.faa
    jobid: 162

Submitted job 162 with external jobid 'Submitted batch job 3614586'.
[Wed Apr  6 13:33:37 2022]
Error in rule Filter_loci:
    jobid: 162
    output: /beegfs/data/soukkal/StageM2/Control_genomes/results/Viral_Homology_results/Viral_loci/Candidate_viral_loci_Nr.m8, /beegfs/data/soukkal/StageM2/Control_genomes/results/Viral_Homology_results/Viral_loci/Candidate_viral_loci_Nr_taxid.m8, /beegfs/data/soukkal/StageM2/Control_genomes/results/Viral_Homology_results/Viral_loci/Candidate_viral_loci_filtered.m8, /beegfs/data/soukkal/StageM2/Control_genomes/results/Viral_Homology_results/Viral_loci/Fasta_viral_loci_filtered.fna, /beegfs/data/soukkal/StageM2/Control_genomes/results/Viral_Homology_results/Viral_loci/Fasta_viral_loci_filtered.faa
    shell:
        
		#Add viral protein sequences within the file with all virus candidate loci
		cat /beegfs/data/soukkal/StageM2/Databases/Refseq_viral_db_nophages_nopolydna_IVSPER.faa  >> /beegfs/data/soukkal/StageM2/Control_genomes/results/Viral_Homology_results/Viral_loci/Candidate_viral_loci_and_viral_protein.aa
		#Search for homology between NR and Candidate viral loci/viral protein
		/beegfs/data/soukkal/TOOLS/mmseqs/bin/mmseqs createdb /beegfs/data/soukkal/StageM2/Control_genomes/results/Viral_Homology_results/Viral_loci/Candidate_viral_loci_and_viral_protein.aa /beegfs/data/soukkal/StageM2/Control_genomes/results/Viral_Homology_results/Viral_loci/All_fasta_viral_loci_db
		/beegfs/data/soukkal/TOOLS/mmseqs/bin/mmseqs search /beegfs/data/soukkal/StageM2/Control_genomes/results/Viral_Homology_results/Viral_loci/All_fasta_viral_loci_db /beegfs/data/bguinet/these/NR_db  /beegfs/data/soukkal/StageM2/Control_genomes/results/Viral_Homology_results/Viral_loci/Candidate_viral_loci_Nr /beegfs/data/soukkal/StageM2/Control_genomes/results/Viral_Homology_results/Viral_loci/Candidate_viral_loci_Nr_tpm 
		/beegfs/data/soukkal/TOOLS/mmseqs/bin/mmseqs convertalis --format-output 'query,tlen,target,pident,alnlen,mismatch,gapopen,qstart,qend,tstart,tend,evalue,bits,tcov' /beegfs/data/soukkal/StageM2/Control_genomes/results/Viral_Homology_results/Viral_loci/All_fasta_viral_loci_db /beegfs/data/bguinet/these/NR_db /beegfs/data/soukkal/StageM2/Control_genomes/results/Viral_Homology_results/Viral_loci/Candidate_viral_loci_Nr /beegfs/data/soukkal/StageM2/Control_genomes/results/Viral_Homology_results/Viral_loci/Candidate_viral_loci_Nr.m8 -s 7 --threads 20
		#Add taxonomic information about hit targets: 
		python3 /beegfs/data/soukkal/StageM2/Scripts/Homology_search/Add_taxid_info.py -b /beegfs/data/soukkal/StageM2/Control_genomes/results/Viral_Homology_results/Viral_loci/Candidate_viral_loci_Nr.m8 -blst Mmseqs2 -d /beegfs/data/bguinet/taxadb2/taxadb.sqlite -o /beegfs/data/soukkal/StageM2/Control_genomes/results/Viral_Homology_results/Viral_loci/Candidate_viral_loci_Nr_taxid.m8
		#Filter mmseqs results using taxonomic information and filter fasta nuc and amino files : 
		python3 /beegfs/data/soukkal/StageM2/Scripts/Homology_search/Filter_loci_with_NR.py -Nr /beegfs/data/soukkal/StageM2/Control_genomes/results/Viral_Homology_results/Viral_loci/Candidate_viral_loci_Nr_taxid.m8 -fna /beegfs/data/soukkal/StageM2/Control_genomes/results/Viral_Homology_results/Viral_loci/All_fasta_viral_loci.fna -faa /beegfs/data/soukkal/StageM2/Control_genomes/results/Viral_Homology_results/Viral_loci/All_fasta_viral_loci.faa -o /beegfs/data/soukkal/StageM2/Control_genomes/results/Viral_Homology_results/Viral_loci/Candidate_viral_loci_filtered.m8 -ofna /beegfs/data/soukkal/StageM2/Control_genomes/results/Viral_Homology_results/Viral_loci/Fasta_viral_loci_filtered.fna -ofaa /beegfs/data/soukkal/StageM2/Control_genomes/results/Viral_Homology_results/Viral_loci/Fasta_viral_loci_filtered.faa
		
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    cluster_jobid: Submitted batch job 3614586

Error executing rule Filter_loci on cluster (jobid: 162, external: Submitted batch job 3614586, jobscript: /beegfs/data/soukkal/StageM2/Scripts/Homology_search/.snakemake/tmp.1si2xued/snakejob.Filter_loci.162.sh). For error details see the cluster log and the log files of the involved rule(s).
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: /beegfs/data/soukkal/StageM2/Scripts/Homology_search/.snakemake/log/2022-04-06T125900.947984.snakemake.log
